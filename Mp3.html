<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>SkyData - تحويل فيديو إلى صوت</title>
    <meta name="description" content="أداة مجانية لاستخراج الصوت من الفيديو وتحويله إلى ملف صوتي قابل للتنزيل والاستماع.">
    <meta name="keywords" content="video to mp3, extract audio, convert video to audio, تحويل فيديو لصوت, استخراج الصوت, SkyData">
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="style.css">

    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({
          appId: "9bc8ff80-a325-4935-ba4d-03e362a3cc5f",
          safari_web_id: "web.onesignal.auto.bfdbea16-3639-4052-8230-1f603036145d",
          notifyButton: { enable: true },
        });
      });
    </script>

    <style>
        /* ==============================================
           1. أساسيات الصفحة (Standard)
           ============================================== */
        body {
            background-color: #0b132b;
            padding-top: 90px !important;
            overflow-x: hidden;
            font-family: 'Cairo', sans-serif;
            display: block; 
        }

        *, *::before, *::after {
            -webkit-tap-highlight-color: transparent !important;
            outline: none !important;
            box-shadow: none !important;
            box-sizing: border-box;
        }
        *:focus { outline: none; border-color: transparent !important; }

        /* الهيدر المثبت */
        .main-header {
            height: 70px !important; 
            background-color: #0b132b !important;
            border-bottom: 1px solid #1f2d4d;
            padding: 0 !important;
            position: fixed; top: 0; width: 100%; z-index: 2000;
            display: flex !important; align-items: center !important;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .main-header .container {
            width: 100% !important; height: 100% !important; max-width: 100% !important;
            padding: 0 20px !important;
            display: flex !important; justify-content: space-between !important;
            align-items: center !important; margin: 0 !important;
        }

        .logo-img { height: 35px !important; width: auto; }

        /* زر القائمة */
        .hamburger { cursor: pointer; height: 30px; width: 30px; position: relative; z-index: 2002; }
        .hamburger input { display: none; }
        .hamburger svg { height: 30px; transition: transform 600ms cubic-bezier(0.4, 0, 0.2, 1); }
        .line { fill: none; stroke: white; stroke-linecap: round; stroke-linejoin: round; stroke-width: 3; transition: stroke-dasharray 600ms cubic-bezier(0.4, 0, 0.2, 1), stroke-dashoffset 600ms cubic-bezier(0.4, 0, 0.2, 1); }
        .line-top-bottom { stroke-dasharray: 12 63; }
        .hamburger input:checked + svg { transform: rotate(-45deg); }
        .hamburger input:checked + svg .line-top-bottom { stroke-dasharray: 20 300; stroke-dashoffset: -32.42; }

        /* القائمة الجانبية */
        .sidebar { z-index: 2001 !important; padding-top: 20px !important; background-color: #111a30; box-shadow: -5px 0 20px rgba(0,0,0,0.5); }
        
        .sidebar-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 1500;
            opacity: 0; visibility: hidden; transition: 0.3s; backdrop-filter: blur(3px);
        }
        .sidebar-overlay.active { opacity: 1; visibility: visible; }

        .sidebar-footer { margin-top: 20px; border-top: 1px solid #2a3a5a; padding: 20px; text-align: center; }
        .social-links a { margin: 0 8px; color: #aaa; font-size: 20px; transition: 0.3s; }
        .social-links a:hover { color: #00aaff; }
        .footer-nav { display: flex; justify-content: center; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .footer-nav a { color: #ccc; font-size: 13px; }
        .copyright { font-size: 12px; color: #666; }


        /* ==============================================
           2. تنسيقات أداة تحويل الصوت
           ============================================== */

        .container-tool { max-width: 800px; margin: 0 auto; padding: 20px; }

        .tool-box {
            background-color: #111a30; padding: 30px;
            border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border: 1px solid #2a3a5a; text-align: center;
        }
        
        h1 { color: #00aaff; margin-bottom: 20px; }

        /* منطقة الرفع */
        #video-input { display: none; }
        .file-upload-label {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background-color: #0e1624; color: #fff; border: 2px dashed #2a3a5a;
            padding: 40px; border-radius: 10px; cursor: pointer; transition: 0.3s;
            gap: 15px; margin-bottom: 20px;
        }
        .file-upload-label:hover { border-color: #00aaff; background: #152036; }
        .file-upload-label i { font-size: 40px; color: #00aaff; }
        .upload-hint { font-size: 13px; color: #777; margin-top: 5px; }

        /* مشغل الصوت والنتيجة */
        #result-area { display: none; margin-top: 30px; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        audio {
            width: 100%; margin-bottom: 20px; border-radius: 30px;
            filter: invert(1) hue-rotate(180deg); /* لتتناسب مع الوضع المظلم */
        }

        .file-info {
            background: #0e1624; padding: 10px; border-radius: 8px;
            margin-bottom: 15px; color: #ccc; font-size: 14px; border: 1px solid #2a3a5a;
        }

        /* أزرار التحكم */
        .action-row { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
        
        .btn-action {
            padding: 12px 30px; border: none; border-radius: 8px;
            font-weight: bold; cursor: pointer; font-size: 14px;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            color: #fff; transition: 0.2s; min-width: 150px;
        }
        .btn-convert { background: #00aaff; color: #111; }
        .btn-convert:hover { background: #fff; }
        
        .btn-download { background: #27ae60; color: #fff; }
        .btn-download:hover { background: #2ecc71; }
        
        .btn-reset { background: rgba(255, 77, 77, 0.2); color: #ff4d4d; border: 1px solid #ff4d4d; }
        .btn-reset:hover { background: #ff4d4d; color: #fff; }

        /* التحميل */
        #progress-area { display: none; margin: 20px 0; }
        .progress-bar {
            width: 100%; height: 10px; background: #1f2d4d; border-radius: 5px; overflow: hidden;
            border: 1px solid #2a3a5a;
        }
        .progress-fill {
            height: 100%; background: #00aaff; width: 0%; transition: width 0.3s ease;
        }
        .progress-text { color: #aaa; font-size: 12px; margin-top: 5px; }

        /* عنصر فيديو مخفي للاستخراج */
        #hidden-video { display: none; }

        #toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: #e74c3c; color: #fff; padding: 10px 30px; border-radius: 30px;
            font-size: 14px; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 7000;
        }
        #toast.show { opacity: 1; bottom: 50px; }

    </style>
</head>
<body>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

    <header class="main-header">
        <div class="container">
            <a href="index.html" class="logo">
                <img src="https://i.ibb.co/v4vwvcGq/skydatafull.webp" alt="SkyData" class="logo-img">
            </a>
            <label class="hamburger menu-toggle">
              <input type="checkbox" id="menu-checkbox">
              <svg viewBox="0 0 32 32">
                <path class="line line-top-bottom" d="M27 10 13 10C10.8 10 9 8.2 9 6 9 3.5 10.8 2 13 2 15.2 2 17 3.8 17 6L17 26C17 28.2 18.8 30 21 30 23.2 30 25 28.2 25 26 25 23.8 23.2 22 21 22L7 22"></path>
                <path class="line" d="M7 16 27 16"></path>
              </svg>
            </label>
        </div>
    </header>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-section">
            <h4>القسم 1: تعريف واختصار</h4>
            <ul>
                <li><a href="index.html"><i class="fas fa-home"></i> <span>المنزل</span></a></li>
                <li><a href="aboutus.html"><i class="fas fa-users"></i> <span>عنا</span></a></li>
                <li><a href="safety.html"><i class="fas fa-shield-alt"></i> <span>شروط الخدمة</span></a></li>
                <li><a href="support.html"><i class="fas fa-headset"></i> <span>خدمة العملاء</span></a></li>
                <li><a href="login.html" id="auth-link">
                    <i class="fas fa-sign-in-alt"></i> <span>تسجيل الدخول</span>
                </a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <h4 class="ai-title"><i class="fas fa-brain"></i> القسم 2: أدوات AI</h4>
            <ul>
                <li><a href="remove-background-pro.html"><i class="fas fa-eraser"></i> <span>إزالة الخلفية</span></a></li>
                <li><a href="imgscan.html"><i class="fas fa-text-height"></i> <span>تحليل الصور إلى نص</span></a></li>
                <li><a href="logo.html"><i class="fas fa-palette"></i> <span>صنع شعار</span></a></li>
                <li><a href="names.html"><i class="fas fa-random"></i> <span>مولِّد أسماء عشوائية</span></a></li>
                <li><a href="password.html"><i class="fas fa-lock"></i> <span>مولّد كلمات مرور</span></a></li>
                <li><a href="password-strength.html"><i class="fas fa-key"></i> <span>إختبار قوة كلمة السر</span></a></li>
            </ul>
        </div>

        <div class="sidebar-section">
            <h4>القسم 3: أدوات مجانية</h4>
            <ul>
                <li><a href="editor.html"><i class="fas fa-edit"></i> <span>تحرير الصور</span></a></li>
                <li><a href="imgdv.html"><i class="fas fa-compress-arrows-alt"></i> <span>ضغط الصور</span></a></li>
                <li><a href="imgtag.html"><i class="fas fa-link"></i> <span>تحويل صور إلى روابط</span></a></li>
                <li><a href="pdf.html"><i class="fas fa-file-pdf"></i> <span>تحويل صور إلى PDF</span></a></li>
                <li><a href="qr.html"><i class="fas fa-qrcode"></i> <span>صانع كود QR</span></a></li>
                <li><a href="size.html"><i class="fas fa-expand-arrows-alt"></i> <span>تغيير أبعاد الصورة</span></a></li>
                <li><a href="zoom.html"><i class="fas fa-search-plus"></i> <span>تكبير دقة الصورة</span></a></li>
                <li><a href="note.html"><i class="fas fa-sticky-note"></i> <span>مذكرة فورية</span></a></li>
                <li><a href="age.html"><i class="fas fa-calendar-alt"></i> <span>حساب الفرق بين تاريخين</span></a></li>
                
                <li><a href="prayer.html"><i class="fas fa-mosque"></i> <span>أوقات الصلاة</span></a></li>
                <li><a href="data.city.html"><i class="fas fa-cloud-sun-rain"></i> <span>الطقس</span></a></li>

                <li><a href="txtpdf.html"><i class="fas fa-file-word"></i> <span>تحويل النص إلى PDF</span></a></li>
                <li><a href="Mp3.html" style="background: rgba(0, 170, 255, 0.1); color: #fff;"><i class="fas fa-file-audio"></i> <span>تحويل فيديو إلى MP3</span></a></li>
                <li><a href="coler.html"><i class="fas fa-swatchbook"></i> <span>أداة ألوان (Picker)</span></a></li>
                <li><a href="units.html"><i class="fas fa-exchange-alt"></i> <span>محوّلات وحدات</span></a></li>
                <li><a href="cameqr.html"><i class="fas fa-camera"></i> <span>قارئ QR من الكاميرا</span></a></li>
                <li><a href="recorder.html"><i class="fas fa-microphone"></i> <span>تسجيل صوت</span></a></li>
                <li><a href="v-o-edit.html"><i class="fas fa-cut"></i> <span>قص مقطع صوت/فيديو</span></a></li>
                <li><a href="money.html"><i class="fas fa-money-bill-wave"></i> <span>تحويل العملات</span></a></li>
                <li><a href="calculator.html"><i class="fas fa-calculator"></i> <span>الة حاسبة</span></a></li>
                <li><a href="arbtxt.html"><i class="fas fa-font"></i> <span>زخرفة نصوص عربية</span></a></li>
                <li><a href="engtxt.html"><i class="fas fa-spell-check"></i> <span>زخرفة نصوص إنجليزية</span></a></li>
                <li><a href="emoji.html"><i class="fas fa-smile"></i> <span>رموز و إيموجي</span></a></li>
                <li><a href="more.html"><i class="fas fa-sort-amount-up"></i> <span>استخراج الكلمات المكررة</span></a></li>
                <li><a href="fix.html"><i class="fas fa-check-double"></i> <span>تصحيح إملائي</span></a></li>
                <li><a href="pixels.html"><i class="fas fa-draw-polygon"></i> <span>رسم & Pixel</span></a></li>
                <li><a href="hide.html"><i class="fas fa-eye-slash"></i> <span>حروف مخفية</span></a></li>
                <li><a href="kill.html"><i class="fas fa-th-large"></i> <span>تقسيم نص</span></a></li>
                <li><a href="delete.html"><i class="fas fa-trash-alt"></i> <span>حذف الأسطر المكررة</span></a></li>
                <li><a href="gif.html"><i class="fas fa-film"></i> <span>تحويل فيديو إلى GIF</span></a></li>
                <li><a href="morse.html"><i class="fas fa-ellipsis-h"></i> <span>شيفرة مورس</span></a></li>
                <li><a href="hash.html"><i class="fas fa-hashtag"></i> <span>مولد Hash</span></a></li>
                <li><a href="crypto.html"><i class="fas fa-shield-virus"></i> <span>تشفير AES</span></a></li>
                <li><a href="url.html"><i class="fas fa-shield-alt"></i> <span>كشف روابط ضارة</span></a></li>
                <li><a href="voyse.html"><i class="fas fa-volume-up"></i> <span>قياس الضوضاء (dB)</span></a></li>
                <li><a href="base64.html"><i class="fas fa-retweet"></i> <span>تشفير Base64</span></a></li>
                <li><a href="yaml.html"><i class="fas fa-file-code"></i> <span>JSON ↔ YAML</span></a></li>
                <li><a href="codegood.html"><i class="fas fa-code"></i> <span>تنسيق الأكواد</span></a></li>
                <li><a href="dns.html"><i class="fas fa-network-wired"></i> <span>فحص DNS</span></a></li>
                <li><a href="csv.html"><i class="fas fa-file-csv"></i> <span>CSV ↔ JSON</span></a></li>
                <li><a href="zip.html"><i class="fas fa-file-archive"></i> <span>تجميع ملفات ZIP</span></a></li>
                <li><a href="imgcut.html"><i class="fas fa-crop-alt"></i> <span>قص الصور بأشكال</span></a></li>
                <li><a href="safetymake.html"><i class="fas fa-file-signature"></i> <span>مولد سياسة الخصوصية</span></a></li>
                <li><a href="goodarbtxt.html"><i class="fas fa-text-width"></i> <span>ضغط خطوط الويب</span></a></li>
            </ul>
        </div>
        
        <div class="sidebar-footer">
            <div class="social-links">
                <a href="https://discord.gg/6m3c2up4p3" target="_blank"><i class="fab fa-discord"></i></a>
                <a href="https://youtube.com/@skydataa" target="_blank"><i class="fab fa-youtube"></i></a>
                <a href="update.html"><i class="fab fa-android"></i> <span>تحميل التطبيق</span></a>
            </div>
            <div class="footer-nav">
                <a href="safety.html"><i class="fas fa-shield-alt"></i> <span>الخصوصية</span></a>
                <a href="aboutus.html"><i class="fas fa-users"></i> <span>عنا</span></a>
                <a href="help.html"><i class="fas fa-hands-helping"></i> <span>ادعمنا</span></a>
            </div>
            <p class="copyright">SkyData © 2025</p>
        </div>
    </nav>

    <main class="container-tool">
        
        <div class="tool-box">
            <h1><i class="fas fa-file-audio"></i> تحويل الفيديو إلى صوت</h1>
            
            <div id="upload-section">
                <label for="video-input" class="file-upload-label" id="upload-label">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>اختر ملف الفيديو</span>
                    <span class="upload-hint">الحد الأقصى: 100 ميجابايت | المدة: 5 دقائق</span>
                </label>
                <input type="file" id="video-input" accept="video/*">
            </div>

            <div id="progress-area">
                <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                <p class="progress-text" id="progress-text">جاري المعالجة...</p>
            </div>

            <div id="result-area">
                <div class="file-info" id="file-info"></div>
                <audio id="audio-player" controls></audio>
                
                <div class="action-row">
                    <a id="download-btn" class="btn-action btn-download" download="audio.wav">
                        <i class="fas fa-download"></i> تحميل الملف
                    </a>
                    <button class="btn-action btn-reset" onclick="resetTool()">
                        <i class="fas fa-redo"></i> تحويل آخر
                    </button>
                </div>
            </div>

            <video id="hidden-video" controls></video>

        </div>
    </main>

    <div id="toast">تنبيه</div>

    <script>
        // --- فتح/إغلاق القائمة ---
        const menuCheckbox = document.getElementById('menu-checkbox');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');

        function toggleMenu(open) {
            if(open) { sidebar.classList.add('open'); overlay.classList.add('active'); menuCheckbox.checked = true; }
            else { sidebar.classList.remove('open'); overlay.classList.remove('active'); menuCheckbox.checked = false; }
        }
        menuCheckbox.addEventListener('change', (e) => toggleMenu(e.target.checked));
        overlay.addEventListener('click', () => toggleMenu(false));

        // --- منطق التحويل ---
        const videoInput = document.getElementById('video-input');
        const uploadLabel = document.getElementById('upload-label');
        const progressArea = document.getElementById('progress-area');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const resultArea = document.getElementById('result-area');
        const audioPlayer = document.getElementById('audio-player');
        const downloadBtn = document.getElementById('download-btn');
        const fileInfo = document.getElementById('file-info');
        const hiddenVideo = document.getElementById('hidden-video');
        const toast = document.getElementById('toast');

        const MAX_SIZE = 100 * 1024 * 1024; // 100MB
        const MAX_DURATION = 300; // 5 Minutes (300 seconds)

        function showToast(msg) {
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        videoInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if(!file) return;

            // 1. فحص الحجم
            if(file.size > MAX_SIZE) {
                showToast("عذراً، حجم الملف أكبر من 100 ميجابايت.");
                this.value = "";
                return;
            }

            // بدء التحميل والمعاينة للتحقق من المدة
            uploadLabel.style.display = 'none';
            progressArea.style.display = 'block';
            progressText.innerText = "جاري فحص الملف...";
            progressFill.style.width = "20%";

            const url = URL.createObjectURL(file);
            hiddenVideo.src = url;

            hiddenVideo.onloadedmetadata = function() {
                // 2. فحص المدة
                if(hiddenVideo.duration > MAX_DURATION) {
                    showToast("عذراً، مدة الفيديو تتجاوز 5 دقائق.");
                    resetTool();
                    return;
                }
                
                // إذا نجح الفحص، ابدأ التحويل
                progressText.innerText = "جاري استخراج الصوت...";
                progressFill.style.width = "50%";
                extractAudio(file);
            };

            hiddenVideo.onerror = function() {
                showToast("ملف الفيديو غير صالح.");
                resetTool();
            };
        });

        function extractAudio(file) {
            // استخدام Web Audio API لاستخراج الصوت
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const reader = new FileReader();

            reader.onload = function(e) {
                const arrayBuffer = e.target.result;
                
                audioContext.decodeAudioData(arrayBuffer, function(buffer) {
                    progressFill.style.width = "90%";
                    
                    // تحويل Buffer إلى ملف WAV
                    const wavBlob = bufferToWave(buffer, buffer.length);
                    const audioUrl = URL.createObjectURL(wavBlob);
                    
                    // عرض النتيجة
                    audioPlayer.src = audioUrl;
                    downloadBtn.href = audioUrl;
                    // تغيير اسم الملف عند التنزيل
                    downloadBtn.download = file.name.split('.')[0] + ".wav";
                    
                    fileInfo.innerText = `تم استخراج الصوت من: ${file.name}`;
                    
                    progressArea.style.display = 'none';
                    resultArea.style.display = 'block';
                    
                }, function(e) {
                    showToast("فشل في معالجة الصوت. قد تكون الصيغة غير مدعومة.");
                    resetTool();
                });
            };

            reader.readAsArrayBuffer(file);
        }

        // دالة مساعدة لتحويل AudioBuffer إلى WAV Blob
        function bufferToWave(abuffer, len) {
            let numOfChan = abuffer.numberOfChannels,
                length = len * numOfChan * 2 + 44,
                buffer = new ArrayBuffer(length),
                view = new DataView(buffer),
                channels = [], i, sample,
                offset = 0,
                pos = 0;
            
            // كتابة ترويسة WAV
            setUint32(0x46464952); // "RIFF"
            setUint32(length - 8); // file length - 8
            setUint32(0x45564157); // "WAVE"

            setUint32(0x20746d66); // "fmt " chunk
            setUint32(16); // length = 16
            setUint16(1); // PCM (uncompressed)
            setUint16(numOfChan);
            setUint32(abuffer.sampleRate);
            setUint32(abuffer.sampleRate * 2 * numOfChan); // avg. bytes/sec
            setUint16(numOfChan * 2); // block-align
            setUint16(16); // 16-bit (hardcoded in this function)

            setUint32(0x61746164); // "data" - chunk
            setUint32(length - pos - 4); // chunk length

            // كتابة البيانات
            for(i = 0; i < abuffer.numberOfChannels; i++)
                channels.push(abuffer.getChannelData(i));

            while(pos < length) {
                for(i = 0; i < numOfChan; i++) {
                    // تداخل القنوات (Interleave channels)
                    sample = Math.max(-1, Math.min(1, channels[i][offset])); // clamp
                    sample = (0.5 + sample < 0 ? sample * 32768 : sample * 32767)|0; // scale to 16-bit signed int
                    view.setInt16(pos, sample, true); // write 16-bit sample
                    pos += 2;
                }
                offset++;
            }

            return new Blob([buffer], {type: "audio/wav"});

            function setUint16(data) {
                view.setUint16(pos, data, true);
                pos += 2;
            }

            function setUint32(data) {
                view.setUint32(pos, data, true);
                pos += 4;
            }
        }

        function resetTool() {
            videoInput.value = '';
            hiddenVideo.src = '';
            audioPlayer.src = '';
            uploadLabel.style.display = 'flex';
            progressArea.style.display = 'none';
            resultArea.style.display = 'none';
            progressFill.style.width = '0%';
        }

    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAw_EI5sOrqvxWn-5DZgG_t0rgF910T-wE",
            authDomain: "skydata-ai.firebaseapp.com",
            projectId: "skydata-ai"
        };

        try {
            const app = initializeApp(firebaseConfig);
            const auth = getAuth(app);
            const authLink = document.getElementById('auth-link');
            if (authLink) {
                const ico = authLink.querySelector('i'); const txt = authLink.querySelector('span');
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        authLink.href = 'menu.html'; ico.className = 'fas fa-user-circle'; txt.textContent = 'ملف الشخصي';
                    } else {
                        authLink.href = 'login.html'; ico.className = 'fas fa-sign-in-alt'; txt.textContent = 'تسجيل الدخول';
                    }
                });
            }
        } catch (e) { console.error("Firebase Error:", e); }
    </script>

</body>
</html>