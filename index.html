<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>AI Chat â€“ Puter.js</title>

<script src="https://js.puter.com/v2/"></script>

<style>
    body {
        margin: 0;
        font-family: sans-serif;
        background: #f7f7f8;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    /* ===== Ø´Ø±ÙŠØ· Ø£Ø¹Ù„Ù‰ ===== */
    header {
        background: white;
        padding: 12px 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e5e5e5;
    }
    header h1 {
        font-size: 18px;
        margin: 0;
    }

    /* ===== Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ===== */
    #chat {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
    }

    .msg {
        max-width: 90%;
        padding: 12px 16px;
        margin-bottom: 12px;
        border-radius: 12px;
        line-height: 1.6;
        font-size: 15px;
        white-space: pre-wrap;
    }
    .me {
        background: #d2e3ff;
        align-self: flex-start;
    }
    .ai {
        background: #fff;
        border: 1px solid #eee;
        align-self: flex-end;
    }

    /* ===== ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙƒØªØ§Ø¨Ø© ===== */
    #inputArea {
        display: flex;
        gap: 10px;
        padding: 14px;
        background: white;
        border-top: 1px solid #e5e5e5;
    }

    #prompt {
        flex: 1;
        padding: 12px;
        border-radius: 10px;
        border: 1px solid #ccc;
        font-size: 15px;
        outline: none;
    }

    button {
        border: none;
        background: #007aff;
        color: white;
        padding: 12px 16px;
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
    }

    button svg {
        width: 20px;
    }

    .icon-btn {
        background: #eee;
        color: black;
        padding: 10px;
        border-radius: 10px;
    }

    .icon-btn svg {
        width: 22px;
    }

    /* ===== Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ ===== */
    #modelSelector {
        padding: 8px;
        border-radius: 10px;
        border: 1px solid #ccc;
        font-size: 14px;
    }

    /* ===== Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù‡Ø§ØªÙ ===== */
    @media (max-width: 600px) {
        #prompt { font-size: 14px; }
        button { padding: 10px; }
    }
</style>
</head>
<body>

<header>
    <h1>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h1>

    <select id="modelSelector">
        <option value="gpt-5.1">GPT-5.1</option>
        <option value="gpt-5">GPT-5</option>
        <option value="gpt-5-mini">GPT-5 Mini</option>
        <option value="gpt-5-nano">GPT-5 Nano</option>
        <option value="gpt-4o">GPT-4o</option>
        <option value="o3-mini">O3 Mini</option>
    </select>
</header>

<div id="chat"></div>

<!-- ========== Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª + Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ========== -->
<div id="inputArea">

    <!-- Ø²Ø± ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ±Ø© -->
    <button class="icon-btn" onclick="makeImage()">
        <svg fill="black" viewBox="0 0 24 24"><path d="M21 19V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14l4-4 4 4 4-4 4 4z"/></svg>
    </button>

    <!-- Ø²Ø± ØªØ­Ù„ÙŠÙ„ ØµÙˆØ±Ø© -->
    <button class="icon-btn" onclick="uploadImage()">
        <svg fill="black" viewBox="0 0 24 24"><path d="M5 20h14a2 2 0 0 0 2-2V8h-6l-2-3H5a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2z"/></svg>
    </button>

    <input id="prompt" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">

    <button onclick="sendMessage()">
        <svg fill="white" viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
    </button>
</div>

<!-- Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„ -->
<input type="file" id="imageInput" accept="image/*" style="display:none">


<script>

function addMessage(text, type) {
    const msg = document.createElement("div");
    msg.className = "msg " + type;
    msg.textContent = text;
    document.getElementById("chat").appendChild(msg);
    msg.scrollIntoView({ behavior: "smooth" });
}

/* ========= Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ø§Ø¯ÙŠØ© ========= */
async function sendMessage() {
    const text = prompt.value.trim();
    if (!text) return;

    addMessage(text, "me");
    prompt.value = "";

    const model = modelSelector.value;
    addMessage("Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØªØ§Ø¨Ø©...", "ai");

    const reply = await puter.ai.chat(text, { model });

    document.querySelector(".ai:last-child").textContent = reply;
}

/* ========= ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ±Ø© ========= */
async function makeImage() {
    const promptText = prompt.value.trim();
    if (!promptText) return alert("Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹!");

    addMessage("ğŸ¨ ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ±Ø©...", "ai");

    const img = await puter.ai.txt2img(promptText, { model: "gpt-image-1" });

    document.getElementById("chat").appendChild(img);
    img.style.width = "60%";
    img.style.borderRadius = "10px";
    img.style.margin = "10px 0";
    img.scrollIntoView({ behavior: "smooth" });
}

/* ========= ØªØ­Ù„ÙŠÙ„ ØµÙˆØ±Ø© ========= */
function uploadImage() {
    document.getElementById("imageInput").click();
}

imageInput.onchange = async () => {
    const file = imageInput.files[0];
    if (!file) return;

    const url = URL.createObjectURL(file);

    addMessage("ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©â€¦", "ai");

    const response = await puter.ai.chat(
        "What is in this image?",
        url,
        { model: "gpt-5.1" }
    );

    addMessage(response, "ai");
};

</script>
</body>
</html>