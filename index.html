<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AI Assistant</title>

<script src="https://js.puter.com/v2/"></script>

<style>
    body {
        margin: 0;
        font-family: sans-serif;
        background: #f7f7f8;
        height: 100vh;
        display: flex;
        flex-direction: column;
    }
    header {
        background: white;
        padding: 12px 16px;
        border-bottom: 1px solid #ddd;
        display: flex;
        gap: 12px;
        align-items: center;
    }
    header h1 {
        margin: 0;
        font-size: 17px;
    }
    #chat {
        flex: 1;
        overflow-y: auto;
        padding: 18px;
    }
    .msg {
        padding: 12px 15px;
        margin-bottom: 12px;
        border-radius: 12px;
        max-width: 85%;
        line-height: 1.6;
        font-size: 15px;
        white-space: pre-wrap;
    }
    .me { background: #d2e3ff; align-self: flex-start; }
    .ai { background: white; border: 1px solid #eee; align-self: flex-end;}
    #inputArea {
        background: white;
        padding: 12px;
        display: flex;
        gap: 10px;
        border-top: 1px solid #ddd;
    }
    #prompt {
        flex: 1;
        padding: 12px;
        border-radius: 10px;
        border: 1px solid #ccc;
        outline: none;
    }
    button {
        border: none;
        padding: 10px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        cursor: pointer;
    }
    .icon-btn {
        background: #eee;
    }
    .icon-btn svg, button svg { width: 22px; }
    .send-btn { background: #007aff; color: white; }
</style>
</head>
<body>

<header>
    <h1>ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä</h1>

    <select id="modelSelector">
        <option value="gpt-5.1">GPT-5.1</option>
        <option value="gpt-5">GPT-5</option>
        <option value="gpt-5-mini">GPT-5 Mini</option>
        <option value="gpt-5-nano">GPT-5 Nano</option>
        <option value="gpt-4o">GPT-4o</option>
    </select>
</header>

<div id="chat"></div>

<!-- ==== ÿßŸÑÿ£ÿØŸàÿßÿ™ ==== -->
<div id="inputArea">
    <button class="icon-btn" onclick="makeImage()">
        <svg viewBox="0 0 24 24"><path d="M21 19V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14l4-4 4 4 4-4 4 4z"/></svg>
    </button>

    <button class="icon-btn" onclick="chooseImage()">
        <svg viewBox="0 0 24 24"><path d="M5 20h14a2 2 0 0 0 2-2V8h-6l-2-3H5a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2z"/></svg>
    </button>

    <input id="prompt" placeholder="ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ™ŸÉ...">

    <button class="send-btn" onclick="sendMessage()">
        <svg viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
    </button>
</div>

<input type="file" id="imageInput" accept="image/*" style="display:none">

<script>
/* ========== ÿ™ŸáŸäÿ¶ÿ© Puter (ŸäŸÖŸÜÿπ ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™Ÿàÿ¨ŸäŸá) ========== */
(async () => {
    await puter.init({ anonymous: true });
})();

/* ========= ÿ£ÿØŸàÿßÿ™ ŸÖÿ≥ÿßÿπÿØÿ© ========= */
function addMessage(text, type) {
    const el = document.createElement("div");
    el.className = "msg " + type;
    el.textContent = text;
    document.getElementById("chat").appendChild(el);
    el.scrollIntoView({ behavior: "smooth" });
}

/* ========= ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ© ========= */
async function sendMessage() {
    const promptInput = document.getElementById("prompt");
    const text = promptInput.value.trim();
    if (!text) return;

    addMessage(text, "me");
    promptInput.value = "";

    addMessage("ÿ¨ÿßÿ±Ÿç ÿßŸÑŸÉÿ™ÿßÿ®ÿ©...", "ai");

    const model = document.getElementById("modelSelector").value;

    const reply = await puter.ai.chat(text, { model });

    document.querySelector(".ai:last-child").textContent = reply;
}

/* ========= ÿ™ŸàŸÑŸäÿØ ÿµŸàÿ±ÿ© ========= */
async function makeImage() {
    const promptInput = document.getElementById("prompt");
    const text = promptInput.value.trim();
    if (!text) return alert("ÿ£ÿØÿÆŸÑ ŸàÿµŸÅ ÿßŸÑÿµŸàÿ±ÿ© ÿ£ŸàŸÑÿßŸã");

    addMessage("üé® ÿ™ŸàŸÑŸäÿØ ÿµŸàÿ±ÿ©...", "ai");

    const img = await puter.ai.txt2img(text, { model: "gpt-image-1" });

    document.getElementById("chat").appendChild(img);
    img.style.width = "70%";
    img.style.borderRadius = "10px";
}

/* ========= ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸàÿ±ÿ© ŸÑŸÑÿ™ÿ≠ŸÑŸäŸÑ ========= */
function chooseImage() {
    document.getElementById("imageInput").click();
}

imageInput.onchange = async () => {
    const file = imageInput.files[0];
    if (!file) return;

    const url = URL.createObjectURL(file);

    addMessage("üîç ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ©...", "ai");

    const response = await puter.ai.chat("Describe this image", url, {
        model: "gpt-5.1"
    });

    addMessage(response, "ai");
};
</script>

</body>
</html>